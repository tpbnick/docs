<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=icon href=https://nicklyss.com/media/uploads/2020/12/nord.png><meta name=generator content="mkdocs-1.2.3, mkdocs-material-8.1.7"><title>Memory Problems - Nick's Docs</title><link rel=stylesheet href=../assets/stylesheets/main.cd566b2a.min.css><link rel=stylesheet href=../assets/stylesheets/palette.e6a45f82.min.css><link rel=stylesheet href=../css/lightgallery.min.css><script src=../js/lightgallery.min.js></script><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../stylesheets/extra.css><script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary data-md-color-accent> <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#memory-problems class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Nick's Docs" class="md-header__button md-logo" aria-label="Nick's Docs" data-md-component=logo> <img src=https://nicklyss.com/media/uploads/2020/12/nord2.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Nick's Docs </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Memory Problems </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary data-md-color-accent aria-label="Switch to dark mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary data-md-color-accent aria-label="Switch to light mode" type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/tpbnick/docs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> tpbnick/docs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=.. class=md-tabs__link> Home </a> </li> <li class=md-tabs__item> <a href=../portfolio/ class=md-tabs__link> Nick's Portfolio </a> </li> <li class=md-tabs__item> <a href=../notes/ class="md-tabs__link md-tabs__link--active"> Programming Notes </a> </li> <li class=md-tabs__item> <a href=../about/ class=md-tabs__link> About </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Nick's Docs" class="md-nav__button md-logo" aria-label="Nick's Docs" data-md-component=logo> <img src=https://nicklyss.com/media/uploads/2020/12/nord2.png alt=logo> </a> Nick's Docs </label> <div class=md-nav__source> <a href=https://github.com/tpbnick/docs title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> tpbnick/docs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> Home </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Nick's Portfolio <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Nick's Portfolio" data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Nick's Portfolio </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../portfolio/ class=md-nav__link> Main Portfolio </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Google Chrome User Guide <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Google Chrome User Guide" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Google Chrome User Guide </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../chrome/ class=md-nav__link> What is Google Chrome? </a> </li> <li class=md-nav__item> <a href=../chromeinstall/ class=md-nav__link> Google Chrome Install </a> </li> <li class=md-nav__item> <a href=../chrome-extensions/ class=md-nav__link> Google Chrome Extensions/Themes </a> </li> <li class=md-nav__item> <a href=../chromemedia/ class=md-nav__link> Google Chrome Media </a> </li> <li class=md-nav__item> <a href=../glossary/ class=md-nav__link> Glossary </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Programming Notes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Programming Notes" data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Programming Notes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../notes/ class=md-nav__link> Notes Overview </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2 checked> <label class=md-nav__link for=__nav_3_2> C <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=C data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> C </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../c/ class=md-nav__link> C Basics </a> </li> <li class=md-nav__item> <a href=../c-arrays/ class=md-nav__link> Arrays </a> </li> <li class=md-nav__item> <a href=../c-functions/ class=md-nav__link> Functions </a> </li> <li class=md-nav__item> <a href=../c-cl-arguments/ class=md-nav__link> Command Line Arguments </a> </li> <li class=md-nav__item> <a href=../c-variable-scope/ class=md-nav__link> Variables and Scope </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_6 type=checkbox id=__nav_3_2_6> <label class=md-nav__link for=__nav_3_2_6> Algorithms <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Algorithms data-md-level=3> <label class=md-nav__title for=__nav_3_2_6> <span class="md-nav__icon md-icon"></span> Algorithms </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../c-algorithms/ class=md-nav__link> Algorithm Overview </a> </li> <li class=md-nav__item> <a href=../c-algorithms-problems/ class=md-nav__link> Algorithm Problems </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_7 type=checkbox id=__nav_3_2_7 checked> <label class=md-nav__link for=__nav_3_2_7> Memory <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Memory data-md-level=3> <label class=md-nav__title for=__nav_3_2_7> <span class="md-nav__icon md-icon"></span> Memory </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../c-memory/ class=md-nav__link> Memory Overview </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Memory Problems <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Memory Problems </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#filter class=md-nav__link> Filter </a> <nav class=md-nav aria-label=Filter> <ul class=md-nav__list> <li class=md-nav__item> <a href=#background class=md-nav__link> Background </a> </li> <li class=md-nav__item> <a href=#a-bitmap-more-technical class=md-nav__link> A Bit(map) More Technical </a> </li> <li class=md-nav__item> <a href=#image-filtering class=md-nav__link> Image Filtering </a> </li> <li class=md-nav__item> <a href=#problem-solving class=md-nav__link> Problem Solving </a> </li> <li class=md-nav__item> <a href=#code-and-solution class=md-nav__link> Code and Solution </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recover class=md-nav__link> Recover </a> <nav class=md-nav aria-label=Recover> <ul class=md-nav__list> <li class=md-nav__item> <a href=#background_1 class=md-nav__link> Background </a> </li> <li class=md-nav__item> <a href=#problem-solving_1 class=md-nav__link> Problem Solving </a> </li> <li class=md-nav__item> <a href=#solution class=md-nav__link> Solution </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_8 type=checkbox id=__nav_3_2_8> <label class=md-nav__link for=__nav_3_2_8> Data Structures <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Data Structures" data-md-level=3> <label class=md-nav__title for=__nav_3_2_8> <span class="md-nav__icon md-icon"></span> Data Structures </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../c-data-structures/ class=md-nav__link> Data Structures Overview </a> </li> <li class=md-nav__item> <a href=../c-data-structures-problems/ class=md-nav__link> Data Structures Problem </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../py/ class=md-nav__link> Python Basics </a> </li> <li class=md-nav__item> <a href=../py-data-types/ class=md-nav__link> Variables and Simple Data Types </a> </li> <li class=md-nav__item> <a href=../py-lists/ class=md-nav__link> Lists </a> </li> <li class=md-nav__item> <a href=../py-working-with-lists/ class=md-nav__link> Working with Lists </a> </li> <li class=md-nav__item> <a href=../py-if-statements/ class=md-nav__link> If Statements </a> </li> <li class=md-nav__item> <a href=../py-dictionaries/ class=md-nav__link> Dictionaries </a> </li> <li class=md-nav__item> <a href=../py-user-input-while-loops/ class=md-nav__link> User Input and while Loops </a> </li> <li class=md-nav__item> <a href=../py-functions/ class=md-nav__link> Functions </a> </li> <li class=md-nav__item> <a href=../py-classes/ class=md-nav__link> Classes </a> </li> <li class=md-nav__item> <a href=../py-random/ class=md-nav__link> Random Programs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Java <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Java data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../java/ class=md-nav__link> Java Overview </a> </li> <li class=md-nav__item> <a href=../java-basics/ class=md-nav__link> Java Basics </a> </li> <li class=md-nav__item> <a href=../java-variables/ class=md-nav__link> Variables </a> </li> <li class=md-nav__item> <a href=../java-classes/ class=md-nav__link> Classes </a> </li> <li class=md-nav__item> <a href=../java-conditionals/ class=md-nav__link> Conditionals/Control Flow </a> </li> <li class=md-nav__item> <a href=../java-arrays/ class=md-nav__link> Arrays </a> </li> <li class=md-nav__item> <a href=../java-loops/ class=md-nav__link> Loops </a> </li> <li class=md-nav__item> <a href=../java-string-methods/ class=md-nav__link> String Methods </a> </li> <li class=md-nav__item> <a href=../java-access-scope/ class=md-nav__link> Access, Encapsulation, & Scope </a> </li> <li class=md-nav__item> <a href=../java-inheritance-polymorphism/ class=md-nav__link> Inheritance & Polymorphism </a> </li> <li class=md-nav__item> <a href=../java-debugging/ class=md-nav__link> Debugging </a> </li> <li class=md-nav__item> <a href=../java-2d-arrays/ class=md-nav__link> 2D Arrays </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> JavaScript <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=JavaScript data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> JavaScript </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../js/ class=md-nav__link> JavaScript Basics </a> </li> <li class=md-nav__item> <a href=../js-data-types/ class=md-nav__link> Variables and Simple Data Types </a> </li> <li class=md-nav__item> <a href=../js-conditionals/ class=md-nav__link> Conditional Statements </a> </li> <li class=md-nav__item> <a href=../js-functions/ class=md-nav__link> Functions </a> </li> <li class=md-nav__item> <a href=../js-scope/ class=md-nav__link> Scope </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> SQL <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=SQL data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> SQL </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../sql/ class=md-nav__link> SQL Basics </a> </li> <li class=md-nav__item> <a href=../sql-joins-and-other-queries/ class=md-nav__link> Joins and Other Query Types </a> </li> <li class=md-nav__item> <a href=../sql-random/ class=md-nav__link> Random Problems </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Random <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Random data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Random </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../api/ class=md-nav__link> API Overview </a> </li> <li class=md-nav__item> <a href=../django/ class=md-nav__link> Django </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../about/ class=md-nav__link> About </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#filter class=md-nav__link> Filter </a> <nav class=md-nav aria-label=Filter> <ul class=md-nav__list> <li class=md-nav__item> <a href=#background class=md-nav__link> Background </a> </li> <li class=md-nav__item> <a href=#a-bitmap-more-technical class=md-nav__link> A Bit(map) More Technical </a> </li> <li class=md-nav__item> <a href=#image-filtering class=md-nav__link> Image Filtering </a> </li> <li class=md-nav__item> <a href=#problem-solving class=md-nav__link> Problem Solving </a> </li> <li class=md-nav__item> <a href=#code-and-solution class=md-nav__link> Code and Solution </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#recover class=md-nav__link> Recover </a> <nav class=md-nav aria-label=Recover> <ul class=md-nav__list> <li class=md-nav__item> <a href=#background_1 class=md-nav__link> Background </a> </li> <li class=md-nav__item> <a href=#problem-solving_1 class=md-nav__link> Problem Solving </a> </li> <li class=md-nav__item> <a href=#solution class=md-nav__link> Solution </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=memory-problems>Memory Problems</h1> <h2 id=filter>Filter</h2> <p>Implement a program that applies filters to BMPs, per the below: </p> <div class=highlight><pre><span></span><code>$ ./filter -r image.bmp reflected.bmp
</code></pre></div> <h3 id=background><strong>Background</strong></h3> <p>Perhaps the simplest way to represent an image is with a grid of pixels (i.e., dots), each of which can be of a different color. For black-and-white images, we thus need 1 bit per pixel, as 0 could represent black and 1 could represent white, as in the below.</p> <p><div class=lightgallery><a data-sub-html=bitmap href=https://nicklyss.com/wp-content/uploads/2020/05/bitmap.png><img alt=bitmap src=https://nicklyss.com/wp-content/uploads/2020/05/bitmap.png> </a></div></p> <p>In this sense, then, is an image just a bitmap (i.e., a map of bits). For more colorful images, you simply need more bits per pixel. A file format (like <a href=https://en.wikipedia.org/wiki/BMP_file_format>BMP</a>, <a href=https://en.wikipedia.org/wiki/JPEG>JPEG</a>, or <a href=https://en.wikipedia.org/wiki/Portable_Network_Graphics>PNG</a>) that supports “24-bit color” uses 24 bits per pixel. (BMP actually supports 1-, 4-, 8-, 16-, 24-, and 32-bit color.)</p> <p>A 24-bit BMP uses 8 bits to signify the amount of red in a pixel’s color, 8 bits to signify the amount of green in a pixel’s color, and 8 bits to signify the amount of blue in a pixel’s color. If you’ve ever heard of RGB color, well, there you have it: red, green, blue. </p> <p>If the R, G, and B values of some pixel in a BMP are, say, <code>0xff</code>, <code>0x00</code>, and <code>0x00</code> in hexadecimal, that pixel is purely red, as <code>0xff</code> (otherwise known as <code>255</code> in decimal) implies “a lot of red,” while <code>0x00</code> and <code>0x00</code> imply “no green” and “no blue,” respectively. </p> <h3 id=a-bitmap-more-technical><strong>A Bit(map) More Technical</strong></h3> <p>Recall that a file is just a sequence of bits, arranged in some fashion. A 24-bit BMP file, then, is essentially just a sequence of bits, (almost) every 24 of which happen to represent some pixel’s color. But a BMP file also contains some “metadata,” information like an image’s height and width. That metadata is stored at the beginning of the file in the form of two data structures generally referred to as “headers,” not to be confused with C’s header files. (Incidentally, these headers have evolved over time. This problem uses the latest version of Microsoft’s BMP format, 4.0, which debuted with Windows 95.) </p> <p>The first of these headers, called <code>BITMAPFILEHEADER</code>, is 14 bytes long. (Recall that 1 byte equals 8 bits.) The second of these headers, called <code>BITMAPINFOHEADER</code>, is 40 bytes long. Immediately following these headers is the actual bitmap: an array of bytes, triples of which represent a pixel’s color. However, BMP stores these triples backwards (i.e., as BGR), with 8 bits for blue, followed by 8 bits for green, followed by 8 bits for red. (Some BMPs also store the entire bitmap backwards, with an image’s top row at the end of the BMP file. But we’ve stored this problem set’s BMPs as described herein, with each bitmap’s top row first and bottom row last.) In other words, were we to convert the 1-bit smiley above to a 24-bit smiley, substituting red for black, a 24-bit BMP would store this bitmap as follows, where <code>0000ff</code> signifies red and <code>ffffff</code> signifies white; we’ve highlighted in red all instances of <code>0000ff</code>. </p> <p><div class=lightgallery><a data-sub-html=red-smile href=https://nicklyss.com/wp-content/uploads/2020/05/red_smile.png><img alt=red-smile src=https://nicklyss.com/wp-content/uploads/2020/05/red_smile.png> </a></div></p> <p>Because we’ve presented these bits from left to right, top to bottom, in 8 columns, you can actually see the red smiley if you take a step back. </p> <p>To be clear, recall that a hexadecimal digit represents 4 bits. Accordingly, ffffff in hexadecimal actually signifies 111111111111111111111111 in binary. </p> <p>Notice that you could represent a bitmap as a 2-dimensional array of pixels: where the image is an array of rows, each row is an array of pixels. Indeed, that’s how we’ve chosen to represent bitmap images in this problem.</p> <h3 id=image-filtering><strong>Image Filtering</strong></h3> <p>What does it even mean to filter an image? You can think of filtering an image as taking the pixels of some original image, and modifying each pixel in such a way that a particular effect is apparent in the resulting image.</p> <p><strong>Grayscale</strong> </p> <p>One common filter is the “grayscale” filter, where we take an image and want to convert it to black-and-white. How does that work? </p> <p>Recall that if the red, green, and blue values are all set to <code>0x00</code> (hexadecimal for <code>0</code>), then the pixel is black. And if all values are set to <code>0xff</code> (hexadecimal for <code>255</code>), then the pixel is white. So long as the red, green, and blue values are all equal, the result will be varying shades of gray along the black-white spectrum, with higher values meaning lighter shades (closer to white) and lower values meaning darker shades (closer to black).</p> <p>So to convert a pixel to grayscale, we just need to make sure the red, green, and blue values are all the same value. But how do we know what value to make them? Well, it’s probably reasonable to expect that if the original red, green, and blue values were all pretty high, then the new value should also be pretty high. And if the original values were all low, then the new value should also be low. </p> <p>In fact, to ensure each pixel of the new image still has the same general brightness or darkness as the old image, we can take the average of the red, green, and blue values to determine what shade of grey to make the new pixel. </p> <p>If you apply that to each pixel in the image, the result will be an image converted to grayscale.</p> <p><strong>Sepia</strong> </p> <p>Most image editing programs support a “sepia” filter, which gives images an old-timey feel by making the whole image look a bit reddish-brown. </p> <p>An image can be converted to sepia by taking each pixel, and computing new red, green, and blue values based on the original values of the three. </p> <p>There are a number of algorithms for converting an image to sepia, but for this problem, we’ll ask you to use the following algorithm. For each pixel, the sepia color values should be calculated based on the original color values per the below. </p> <div class=highlight><pre><span></span><code>sepiaRed = .393 * originalRed + .769 * originalGreen + .189 * originalBlue
sepiaGreen = .349 * originalRed + .686 * originalGreen + .168 * originalBlue
sepiaBlue = .272 * originalRed + .534 * originalGreen + .131 * originalBlue
</code></pre></div> <p>Of course, the result of each of these formulas may not be an integer, but each value could be rounded to the nearest integer. It’s also possible that the result of the formula is a number greater than 255, the maximum value for an 8-bit color value. In that case, the red, green, and blue values should be capped at 255. As a result, we can guarantee that the resulting red, green, and blue values will be whole numbers between 0 and 255, inclusive.</p> <p><strong>Reflection</strong></p> <p>Some filters might also move pixels around. Reflecting an image, for example, is a filter where the resulting image is what you would get by placing the original image in front of a mirror. So any pixels on the left side of the image should end up on the right, and vice versa. </p> <p>Note that all of the original pixels of the original image will still be present in the reflected image, it’s just that those pixels may have rearranged to be in a different place in the image. </p> <p><strong>Blur</strong> </p> <p>There are a number of ways to create the effect of blurring or softening an image. For this problem, we’ll use the “box blur,” which works by taking each pixel and, for each color value, giving it a new value by averaging the color values of neighboring pixels. </p> <p>Consider the following grid of pixels, where we’ve numbered each pixel.</p> <p><div class=lightgallery><a data-sub-html=grid href=https://nicklyss.com/wp-content/uploads/2020/05/grid.png><img alt=grid src=https://nicklyss.com/wp-content/uploads/2020/05/grid.png> </a></div></p> <p>The new value of each pixel would be the average of the values of all of the pixels that are within 1 row and column of the original pixel (forming a 3x3 box). For example, each of the color values for pixel 6 would be obtained by averaging the original color values of pixels 1, 2, 3, 5, 6, 7, 9, 10, and 11 (note that pixel 6 itself is included in the average). Likewise, the color values for pixel 11 would be be obtained by averaging the color values of pixels 6, 7, 8, 10, 11, 12, 14, 15 and 16. </p> <p>For a pixel along the edge or corner, like pixel 15, we would still look for all pixels within 1 row and column: in this case, pixels 10, 11, 12, 14, 15, and 16.</p> <h3 id=problem-solving><strong>Problem Solving</strong></h3> <p>Get the files for the filter <a href=https://cdn.cs50.net/2019/fall/psets/4/filter/less/filter.zip>HERE</a>. </p> <p>Now let's look at the files provided to help break understand what is inside. </p> <p><strong><code>bmp.h</code></strong> </p> <details class=example> <summary><code>bmp.h</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span>
<span class=normal>60</span>
<span class=normal>61</span>
<span class=normal>62</span>
<span class=normal>63</span>
<span class=normal>64</span>
<span class=normal>65</span>
<span class=normal>66</span>
<span class=normal>67</span>
<span class=normal>68</span>
<span class=normal>69</span>
<span class=normal>70</span>
<span class=normal>71</span>
<span class=normal>72</span>
<span class=normal>73</span>
<span class=normal>74</span>
<span class=normal>75</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=c1>// BMP-related data types based on Microsoft&#39;s own</span>

<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdint.h&gt;</span><span class=cp></span>

<span class=cm>/**</span>
<span class=cm> * Common Data Types</span>
<span class=cm> *</span>
<span class=cm> * The data types in this section are essentially aliases for C/C++</span>
<span class=cm> * primitive data types.</span>
<span class=cm> *</span>
<span class=cm> * Adapted from http://msdn.microsoft.com/en-us/library/cc230309.aspx.</span>
<span class=cm> * See http://en.wikipedia.org/wiki/Stdint.h for more on stdint.h.</span>
<span class=cm> */</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=kt>uint8_t</span><span class=w>  </span><span class=n>BYTE</span><span class=p>;</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=kt>uint32_t</span><span class=w> </span><span class=n>DWORD</span><span class=p>;</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=kt>int32_t</span><span class=w>  </span><span class=n>LONG</span><span class=p>;</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=kt>uint16_t</span><span class=w> </span><span class=n>WORD</span><span class=p>;</span><span class=w></span>

<span class=cm>/**</span>
<span class=cm> * BITMAPFILEHEADER</span>
<span class=cm> *</span>
<span class=cm> * The BITMAPFILEHEADER structure contains information about the type, size,</span>
<span class=cm> * and layout of a file that contains a DIB [device-independent bitmap].</span>
<span class=cm> *</span>
<span class=cm> * Adapted from http://msdn.microsoft.com/en-us/library/dd183374(VS.85).aspx.</span>
<span class=cm> */</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=k>struct</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>WORD</span><span class=w>   </span><span class=n>bfType</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>bfSize</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>WORD</span><span class=w>   </span><span class=n>bfReserved1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>WORD</span><span class=w>   </span><span class=n>bfReserved2</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>bfOffBits</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w> </span><span class=n>__attribute__</span><span class=p>((</span><span class=n>__packed__</span><span class=p>))</span><span class=w></span>
<span class=n>BITMAPFILEHEADER</span><span class=p>;</span><span class=w></span>

<span class=cm>/**</span>
<span class=cm> * BITMAPINFOHEADER</span>
<span class=cm> *</span>
<span class=cm> * The BITMAPINFOHEADER structure contains information about the</span>
<span class=cm> * dimensions and color format of a DIB [device-independent bitmap].</span>
<span class=cm> *</span>
<span class=cm> * Adapted from http://msdn.microsoft.com/en-us/library/dd183376(VS.85).aspx.</span>
<span class=cm> */</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=k>struct</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>biSize</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>LONG</span><span class=w>   </span><span class=n>biWidth</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>LONG</span><span class=w>   </span><span class=n>biHeight</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>WORD</span><span class=w>   </span><span class=n>biPlanes</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>WORD</span><span class=w>   </span><span class=n>biBitCount</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>biCompression</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>biSizeImage</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>LONG</span><span class=w>   </span><span class=n>biXPelsPerMeter</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>LONG</span><span class=w>   </span><span class=n>biYPelsPerMeter</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>biClrUsed</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>DWORD</span><span class=w>  </span><span class=n>biClrImportant</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w> </span><span class=n>__attribute__</span><span class=p>((</span><span class=n>__packed__</span><span class=p>))</span><span class=w></span>
<span class=n>BITMAPINFOHEADER</span><span class=p>;</span><span class=w></span>

<span class=cm>/**</span>
<span class=cm> * RGBTRIPLE</span>
<span class=cm> *</span>
<span class=cm> * This structure describes a color consisting of relative intensities of</span>
<span class=cm> * red, green, and blue.</span>
<span class=cm> *</span>
<span class=cm> * Adapted from http://msdn.microsoft.com/en-us/library/aa922590.aspx.</span>
<span class=cm> */</span><span class=w></span>
<span class=k>typedef</span><span class=w> </span><span class=k>struct</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>BYTE</span><span class=w>  </span><span class=n>rgbtBlue</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>BYTE</span><span class=w>  </span><span class=n>rgbtGreen</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>BYTE</span><span class=w>  </span><span class=n>rgbtRed</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w> </span><span class=n>__attribute__</span><span class=p>((</span><span class=n>__packed__</span><span class=p>))</span><span class=w></span>
<span class=n>RGBTRIPLE</span><span class=p>;</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <p>You’ll see definitions of the headers we’ve mentioned (<code>BITMAPINFOHEADER</code> and <code>BITMAPFILEHEADER</code>). In addition, that file defines <code>BYTE</code>, <code>DWORD</code>, <code>LONG</code>, and <code>WORD</code>, data types normally found in the world of Windows programming. Notice how they’re just aliases for primitives with which you are (hopefully) already familiar. It appears that <code>BITMAPFILEHEADER</code> and <code>BITMAPINFOHEADER</code> make use of these types. </p> <p>Perhaps most importantly, this file also defines a <code>struct</code> called <code>RGBTRIPLE</code> that, quite simply, “encapsulates” three bytes: one blue, one green, and one red (the order, recall, in which we expect to find RGB triples actually on disk).</p> <p>Why are these <code>struct</code>s useful? Well, recall that a file is just a sequence of bytes (or, ultimately, bits) on disk. But those bytes are generally ordered in such a way that the first few represent something, the next few represent something else, and so on. “File formats” exist because the world has standardized what bytes mean what. Now, we could just read a file from disk into RAM as one big array of bytes. And we could just remember that the byte at <code>array[i]</code> represents one thing, while the byte at <code>array[j]</code> represents another. But why not give some of those bytes names so that we can retrieve them from memory more easily? That’s precisely what the structs in <code>bmp.h</code> allow us to do. Rather than think of some file as one long sequence of bytes, we can instead think of it as a sequence of <code>struct</code>s. </p> <p><strong><code>filter.c</code></strong> </p> <details class=example> <summary><code>filter.c</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span>
<span class=normal>104</span>
<span class=normal>105</span>
<span class=normal>106</span>
<span class=normal>107</span>
<span class=normal>108</span>
<span class=normal>109</span>
<span class=normal>110</span>
<span class=normal>111</span>
<span class=normal>112</span>
<span class=normal>113</span>
<span class=normal>114</span>
<span class=normal>115</span>
<span class=normal>116</span>
<span class=normal>117</span>
<span class=normal>118</span>
<span class=normal>119</span>
<span class=normal>120</span>
<span class=normal>121</span>
<span class=normal>122</span>
<span class=normal>123</span>
<span class=normal>124</span>
<span class=normal>125</span>
<span class=normal>126</span>
<span class=normal>127</span>
<span class=normal>128</span>
<span class=normal>129</span>
<span class=normal>130</span>
<span class=normal>131</span>
<span class=normal>132</span>
<span class=normal>133</span>
<span class=normal>134</span>
<span class=normal>135</span>
<span class=normal>136</span>
<span class=normal>137</span>
<span class=normal>138</span>
<span class=normal>139</span>
<span class=normal>140</span>
<span class=normal>141</span>
<span class=normal>142</span>
<span class=normal>143</span>
<span class=normal>144</span>
<span class=normal>145</span>
<span class=normal>146</span>
<span class=normal>147</span>
<span class=normal>148</span>
<span class=normal>149</span>
<span class=normal>150</span>
<span class=normal>151</span>
<span class=normal>152</span>
<span class=normal>153</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;getopt.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>

<span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;helpers.h&quot;</span><span class=cp></span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>argv</span><span class=p>[])</span><span class=w></span>
<span class=p>{</span><span class=w></span>

<span class=w>    </span><span class=c1>// Define allowable filters</span>
<span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>filters</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;bgrs&quot;</span><span class=p>;</span><span class=w></span>

<span class=w>    </span><span class=c1>// Get filter flag and check validity</span>
<span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=n>filter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>getopt</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=n>argv</span><span class=p>,</span><span class=w> </span><span class=n>filters</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>filter</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=sc>&#39;?&#39;</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Invalid filter.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Ensure only one filter</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>getopt</span><span class=p>(</span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=n>argv</span><span class=p>,</span><span class=w> </span><span class=n>filters</span><span class=p>)</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>-1</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Only one filter allowed.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Ensure proper usage</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>argc</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=n>optind</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>2</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Usage: filter [flag] infile outfile</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>3</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Remember filenames</span>
<span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>infile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>argv</span><span class=p>[</span><span class=n>optind</span><span class=p>];</span><span class=w></span>
<span class=w>    </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>outfile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>argv</span><span class=p>[</span><span class=n>optind</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mi>1</span><span class=p>];</span><span class=w></span>

<span class=w>    </span><span class=c1>// Open input file</span>
<span class=w>    </span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>inptr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>infile</span><span class=p>,</span><span class=w> </span><span class=s>&quot;r&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>inptr</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Could not open %s.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>infile</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Open output file</span>
<span class=w>    </span><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>outptr</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>outfile</span><span class=p>,</span><span class=w> </span><span class=s>&quot;w&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>outptr</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fclose</span><span class=p>(</span><span class=n>inptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Could not create %s.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>,</span><span class=w> </span><span class=n>outfile</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>5</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Read infile&#39;s BITMAPFILEHEADER</span>
<span class=w>    </span><span class=n>BITMAPFILEHEADER</span><span class=w> </span><span class=n>bf</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>fread</span><span class=p>(</span><span class=o>&amp;</span><span class=n>bf</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>BITMAPFILEHEADER</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>inptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Read infile&#39;s BITMAPINFOHEADER</span>
<span class=w>    </span><span class=n>BITMAPINFOHEADER</span><span class=w> </span><span class=n>bi</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>fread</span><span class=p>(</span><span class=o>&amp;</span><span class=n>bi</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>BITMAPINFOHEADER</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>inptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Ensure infile is (likely) a 24-bit uncompressed BMP 4.0</span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>bf</span><span class=p>.</span><span class=n>bfType</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mh>0x4d42</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>bf</span><span class=p>.</span><span class=n>bfOffBits</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>54</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>bi</span><span class=p>.</span><span class=n>biSize</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>40</span><span class=w> </span><span class=o>||</span><span class=w></span>
<span class=w>        </span><span class=n>bi</span><span class=p>.</span><span class=n>biBitCount</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>24</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>bi</span><span class=p>.</span><span class=n>biCompression</span><span class=w> </span><span class=o>!=</span><span class=w> </span><span class=mi>0</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fclose</span><span class=p>(</span><span class=n>outptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>fclose</span><span class=p>(</span><span class=n>inptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Unsupported file format.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>6</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>abs</span><span class=p>(</span><span class=n>bi</span><span class=p>.</span><span class=n>biHeight</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>bi</span><span class=p>.</span><span class=n>biWidth</span><span class=p>;</span><span class=w></span>

<span class=w>    </span><span class=c1>// Allocate memory for image</span>
<span class=w>    </span><span class=n>RGBTRIPLE</span><span class=p>(</span><span class=o>*</span><span class=n>image</span><span class=p>)[</span><span class=n>width</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>calloc</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>RGBTRIPLE</span><span class=p>));</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>image</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Not enough memory to store image.</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>fclose</span><span class=p>(</span><span class=n>outptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=n>fclose</span><span class=p>(</span><span class=n>inptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>7</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Determine padding for scanlines</span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>padding</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=p>(</span><span class=mi>4</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=p>(</span><span class=n>width</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>RGBTRIPLE</span><span class=p>))</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>4</span><span class=p>)</span><span class=w> </span><span class=o>%</span><span class=w> </span><span class=mi>4</span><span class=p>;</span><span class=w></span>

<span class=w>    </span><span class=c1>// Iterate over infile&#39;s scanlines</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=c1>// Read row into pixel array</span>
<span class=w>        </span><span class=n>fread</span><span class=p>(</span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>RGBTRIPLE</span><span class=p>),</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>inptr</span><span class=p>);</span><span class=w></span>

<span class=w>        </span><span class=c1>// Skip over padding</span>
<span class=w>        </span><span class=n>fseek</span><span class=p>(</span><span class=n>inptr</span><span class=p>,</span><span class=w> </span><span class=n>padding</span><span class=p>,</span><span class=w> </span><span class=n>SEEK_CUR</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Filter image</span>
<span class=w>    </span><span class=k>switch</span><span class=w> </span><span class=p>(</span><span class=n>filter</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=c1>// Blur</span>
<span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;b&#39;</span><span class=o>:</span><span class=w></span>
<span class=w>            </span><span class=n>blur</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>image</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w></span>

<span class=w>        </span><span class=c1>// Grayscale</span>
<span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;g&#39;</span><span class=o>:</span><span class=w></span>
<span class=w>            </span><span class=n>grayscale</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>image</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w></span>

<span class=w>        </span><span class=c1>// Reflection</span>
<span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;r&#39;</span><span class=o>:</span><span class=w></span>
<span class=w>            </span><span class=n>reflect</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>image</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w></span>

<span class=w>        </span><span class=c1>// Sepia</span>
<span class=w>        </span><span class=k>case</span><span class=w> </span><span class=sc>&#39;s&#39;</span><span class=o>:</span><span class=w></span>
<span class=w>            </span><span class=n>sepia</span><span class=p>(</span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>image</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=k>break</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Write outfile&#39;s BITMAPFILEHEADER</span>
<span class=w>    </span><span class=n>fwrite</span><span class=p>(</span><span class=o>&amp;</span><span class=n>bf</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>BITMAPFILEHEADER</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>outptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Write outfile&#39;s BITMAPINFOHEADER</span>
<span class=w>    </span><span class=n>fwrite</span><span class=p>(</span><span class=o>&amp;</span><span class=n>bi</span><span class=p>,</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>BITMAPINFOHEADER</span><span class=p>),</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>outptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Write new pixels to outfile</span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=c1>// Write row to outfile</span>
<span class=w>        </span><span class=n>fwrite</span><span class=p>(</span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>],</span><span class=w> </span><span class=k>sizeof</span><span class=p>(</span><span class=n>RGBTRIPLE</span><span class=p>),</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>outptr</span><span class=p>);</span><span class=w></span>

<span class=w>        </span><span class=c1>// Write padding at end of row</span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>k</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>padding</span><span class=p>;</span><span class=w> </span><span class=n>k</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>fputc</span><span class=p>(</span><span class=mh>0x00</span><span class=p>,</span><span class=w> </span><span class=n>outptr</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=c1>// Free memory for image</span>
<span class=w>    </span><span class=n>free</span><span class=p>(</span><span class=n>image</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Close infile</span>
<span class=w>    </span><span class=n>fclose</span><span class=p>(</span><span class=n>inptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=c1>// Close outfile</span>
<span class=w>    </span><span class=n>fclose</span><span class=p>(</span><span class=n>outptr</span><span class=p>);</span><span class=w></span>

<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <p>First, notice the definition of <code>filters</code> on line 11. That string tells the program what the allowable command-line arguments to the program are: <code>b</code>, <code>g</code>, <code>r</code>, and <code>s</code>. Each of them specifies a different filter that we might apply to our images: blur, grayscale, reflection, and sepia. </p> <p>The next several lines open up an image file, make sure it’s indeed a BMP file, and read all of the pixel information into a 2D array called <code>image</code>. </p> <p>Scroll down to the <code>switch</code> statement that begins on line 102. Notice that, depending on what <code>filter</code> we’ve chosen, a different function is called: if the user chooses filter <code>b</code>, the program calls the <code>blur</code> function; if <code>g</code>, then <code>grayscale</code> is called; if <code>r</code>, then <code>reflect</code> is called; and if <code>s</code>, then <code>sepia</code> is called. Notice, too, that each of these functions take as arguments the height of the image, the width of the image, and the 2D array of pixels.</p> <p>The remaining lines of the program take the resulting <code>image</code> and write them out to a new image file.</p> <p><strong><code>helpers.h</code></strong> </p> <details class=example> <summary><code>helpers.h</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;bmp.h&quot;</span><span class=cp></span>

<span class=c1>// Convert image to grayscale</span>
<span class=kt>void</span><span class=w> </span><span class=nf>grayscale</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>]);</span><span class=w></span>

<span class=c1>// Convert image to sepia</span>
<span class=kt>void</span><span class=w> </span><span class=nf>sepia</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>]);</span><span class=w></span>

<span class=c1>// Reflect image horizontally</span>
<span class=kt>void</span><span class=w> </span><span class=nf>reflect</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>]);</span><span class=w></span>

<span class=c1>// Blur image</span>
<span class=kt>void</span><span class=w> </span><span class=nf>blur</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>]);</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <p>This file is quite short, and just provides the function prototypes for the functions you saw earlier. </p> <p>Here, take note of the fact that each function takes a 2D array called <code>image</code> as an argument, where <code>image</code> is an array of <code>height</code> many rows, and each row is itself another array of <code>width</code> many <code>GBTRIPLE</code>s. So if <code>image</code> represents the whole picture, then <code>image[0]</code> represents the first row, and <code>image[0][0]</code> represents the pixel in the upper-left corner of the image. </p> <p><strong><code>helpers.c</code></strong> </p> <details class=example> <summary><code>helpers.c</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;helpers.h&quot;</span><span class=cp></span>

<span class=c1>// Convert image to grayscale</span>
<span class=kt>void</span><span class=w> </span><span class=nf>grayscale</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=c1>// Convert image to sepia</span>
<span class=kt>void</span><span class=w> </span><span class=nf>sepia</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=c1>// Reflect image horizontally</span>
<span class=kt>void</span><span class=w> </span><span class=nf>reflect</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=c1>// Blur image</span>
<span class=kt>void</span><span class=w> </span><span class=nf>blur</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <p>Now, open up helpers.c. Here’s where the implementation of the functions declared in helpers.h belong. But note that, right now, the implementations are missing! We will come back to this later. </p> <p><strong><code>Makefile</code></strong> </p> <p><div class=highlight><pre><span></span><code>filter:
    clang -fsanitize=signed-integer-overflow -fsanitize=undefined -ggdb3 -O0 -Qunused-arguments -std=c11 -Wall -Werror -Wextra -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wshadow -o filter filter.c helpers.c
</code></pre></div> Finally, let’s look at <code>Makefile</code>. This file specifies what should happen when we run a terminal command like <code>make filter</code>. Whereas programs you may have written before were confined to just one file, <code>filter</code> seems to use multiple files: <code>filter.c</code>, <code>bmp.h</code>, <code>helpers.h</code>, and <code>helpers.c</code>. So we’ll need to tell make how to compile this file. </p> <p>Try compiling <code>filter</code> for yourself by going to your terminal and running</p> <p><div class=highlight><pre><span></span><code>$ make filter
</code></pre></div> Then, you can run the program by running: </p> <div class=highlight><pre><span></span><code>$ ./filter -g images/yard.bmp out.bmp
</code></pre></div> <p>which takes the image at <code>images/yard.bmp</code>, and generates a new image called <code>out.bmp</code> after running the pixels through the <code>grayscale</code> function. <code>grayscale</code> doesn’t do anything just yet, though, so the output image should look the same as the original yard.</p> <h3 id=code-and-solution><strong>Code and Solution</strong></h3> <p>Here are our goals for the <code>filter</code> program: </p> <ul> <li> <p>The function <code>grayscale</code> should take an image and turn it into a black-and-white version of the same image.</p> </li> <li> <p>The function <code>sepia</code> should take an image and turn it into a sepia version of the same image.</p> </li> <li> <p>The <code>reflect</code> function should take an image and reflect it horizontally.</p> </li> <li> <p>Finally, the <code>blur</code> function should take an image and turn it into a box-blurred version of the same image. </p> </li> </ul> <p>Let's look at <code>helpers.c</code> and add some code: </p> <details class=example> <summary><code>helpers.c</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>  1</span>
<span class=normal>  2</span>
<span class=normal>  3</span>
<span class=normal>  4</span>
<span class=normal>  5</span>
<span class=normal>  6</span>
<span class=normal>  7</span>
<span class=normal>  8</span>
<span class=normal>  9</span>
<span class=normal> 10</span>
<span class=normal> 11</span>
<span class=normal> 12</span>
<span class=normal> 13</span>
<span class=normal> 14</span>
<span class=normal> 15</span>
<span class=normal> 16</span>
<span class=normal> 17</span>
<span class=normal> 18</span>
<span class=normal> 19</span>
<span class=normal> 20</span>
<span class=normal> 21</span>
<span class=normal> 22</span>
<span class=normal> 23</span>
<span class=normal> 24</span>
<span class=normal> 25</span>
<span class=normal> 26</span>
<span class=normal> 27</span>
<span class=normal> 28</span>
<span class=normal> 29</span>
<span class=normal> 30</span>
<span class=normal> 31</span>
<span class=normal> 32</span>
<span class=normal> 33</span>
<span class=normal> 34</span>
<span class=normal> 35</span>
<span class=normal> 36</span>
<span class=normal> 37</span>
<span class=normal> 38</span>
<span class=normal> 39</span>
<span class=normal> 40</span>
<span class=normal> 41</span>
<span class=normal> 42</span>
<span class=normal> 43</span>
<span class=normal> 44</span>
<span class=normal> 45</span>
<span class=normal> 46</span>
<span class=normal> 47</span>
<span class=normal> 48</span>
<span class=normal> 49</span>
<span class=normal> 50</span>
<span class=normal> 51</span>
<span class=normal> 52</span>
<span class=normal> 53</span>
<span class=normal> 54</span>
<span class=normal> 55</span>
<span class=normal> 56</span>
<span class=normal> 57</span>
<span class=normal> 58</span>
<span class=normal> 59</span>
<span class=normal> 60</span>
<span class=normal> 61</span>
<span class=normal> 62</span>
<span class=normal> 63</span>
<span class=normal> 64</span>
<span class=normal> 65</span>
<span class=normal> 66</span>
<span class=normal> 67</span>
<span class=normal> 68</span>
<span class=normal> 69</span>
<span class=normal> 70</span>
<span class=normal> 71</span>
<span class=normal> 72</span>
<span class=normal> 73</span>
<span class=normal> 74</span>
<span class=normal> 75</span>
<span class=normal> 76</span>
<span class=normal> 77</span>
<span class=normal> 78</span>
<span class=normal> 79</span>
<span class=normal> 80</span>
<span class=normal> 81</span>
<span class=normal> 82</span>
<span class=normal> 83</span>
<span class=normal> 84</span>
<span class=normal> 85</span>
<span class=normal> 86</span>
<span class=normal> 87</span>
<span class=normal> 88</span>
<span class=normal> 89</span>
<span class=normal> 90</span>
<span class=normal> 91</span>
<span class=normal> 92</span>
<span class=normal> 93</span>
<span class=normal> 94</span>
<span class=normal> 95</span>
<span class=normal> 96</span>
<span class=normal> 97</span>
<span class=normal> 98</span>
<span class=normal> 99</span>
<span class=normal>100</span>
<span class=normal>101</span>
<span class=normal>102</span>
<span class=normal>103</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;helpers.h&quot;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;math.h&quot;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&quot;cs50.h&quot;</span><span class=cp></span>

<span class=c1>// Convert image to grayscale</span>
<span class=kt>void</span><span class=w> </span><span class=nf>grayscale</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>pixel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>average</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>round</span><span class=p>((</span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtRed</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtBlue</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtGreen</span><span class=p>)</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mf>3.0</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtRed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtBlue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>average</span><span class=p>;</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=c1>// Convert image to sepia using formula given</span>

<span class=kt>int</span><span class=w> </span><span class=nf>capacity</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>value</span><span class=p>)</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>value</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>255</span><span class=w> </span><span class=o>?</span><span class=w> </span><span class=mi>255</span><span class=w> </span><span class=o>:</span><span class=w> </span><span class=n>value</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=kt>void</span><span class=w> </span><span class=nf>sepia</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>pixel</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>originalRed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtRed</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>originalBlue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtBlue</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>originalGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>pixel</span><span class=p>.</span><span class=n>rgbtGreen</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtRed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>capacity</span><span class=p>(</span><span class=n>round</span><span class=p>(</span><span class=mf>0.393</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalRed</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.769</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalGreen</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.189</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalBlue</span><span class=p>));</span><span class=w></span>
<span class=w>            </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>capacity</span><span class=p>(</span><span class=n>round</span><span class=p>(</span><span class=mf>0.349</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalRed</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.686</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalGreen</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.168</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalBlue</span><span class=p>));</span><span class=w></span>
<span class=w>            </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>].</span><span class=n>rgbtBlue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>capacity</span><span class=p>(</span><span class=n>round</span><span class=p>(</span><span class=mf>0.272</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalRed</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.534</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalGreen</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=mf>0.131</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>originalBlue</span><span class=p>));</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=c1>// Reflect image horizontally</span>
<span class=kt>void</span><span class=w> </span><span class=nf>swap</span><span class=p>(</span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pixel1</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=n>pixel2</span><span class=p>)</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>temp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=n>pixel1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=o>*</span><span class=n>pixel1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=o>*</span><span class=n>pixel2</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=o>*</span><span class=n>pixel2</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>temp</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>reflect</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>width</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>2</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>swap</span><span class=p>(</span><span class=o>&amp;</span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>],</span><span class=w> </span><span class=o>&amp;</span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>width</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=o>-</span><span class=w> </span><span class=n>i</span><span class=p>]);</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=c1>// Blur image</span>
<span class=kt>bool</span><span class=w> </span><span class=nf>is_valid</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>)</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&gt;=</span><span class=mi>0</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>width</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>

<span class=n>RGBTRIPLE</span><span class=w> </span><span class=nf>get_blur</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>redValue</span><span class=p>,</span><span class=w> </span><span class=n>blueValue</span><span class=p>,</span><span class=w> </span><span class=n>greenValue</span><span class=p>;</span><span class=w> </span><span class=n>redValue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blueValue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>greenValue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>num_valid_pixels</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>di</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span><span class=w> </span><span class=n>di</span><span class=w> </span><span class=o>&lt;=</span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>di</span><span class=o>++</span><span class=p>)</span><span class=w> </span><span class=c1>// di stand for change in i</span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>dj</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>-1</span><span class=p>;</span><span class=w> </span><span class=n>dj</span><span class=w> </span><span class=o>&lt;=</span><span class=mi>1</span><span class=p>;</span><span class=w> </span><span class=n>dj</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>new_i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>di</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=kt>int</span><span class=w> </span><span class=n>new_j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>dj</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>is_valid</span><span class=p>(</span><span class=n>new_i</span><span class=p>,</span><span class=w> </span><span class=n>new_j</span><span class=p>,</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>))</span><span class=w></span>
<span class=w>            </span><span class=p>{</span><span class=w></span>
<span class=w>                </span><span class=n>num_valid_pixels</span><span class=o>++</span><span class=p>;</span><span class=w></span>
<span class=w>                </span><span class=n>redValue</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>new_i</span><span class=p>][</span><span class=n>new_j</span><span class=p>].</span><span class=n>rgbtRed</span><span class=p>;</span><span class=w></span>
<span class=w>                </span><span class=n>blueValue</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>new_i</span><span class=p>][</span><span class=n>new_j</span><span class=p>].</span><span class=n>rgbtBlue</span><span class=p>;</span><span class=w></span>
<span class=w>                </span><span class=n>greenValue</span><span class=w> </span><span class=o>+=</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>new_i</span><span class=p>][</span><span class=n>new_j</span><span class=p>].</span><span class=n>rgbtGreen</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=p>}</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>blurred_pix</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=n>blurred_pix</span><span class=p>.</span><span class=n>rgbtRed</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>round</span><span class=p>((</span><span class=kt>float</span><span class=p>)</span><span class=n>redValue</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>num_valid_pixels</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=n>blurred_pix</span><span class=p>.</span><span class=n>rgbtGreen</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>round</span><span class=p>((</span><span class=kt>float</span><span class=p>)</span><span class=n>greenValue</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>num_valid_pixels</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=n>blurred_pix</span><span class=p>.</span><span class=n>rgbtBlue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>round</span><span class=p>((</span><span class=kt>float</span><span class=p>)</span><span class=n>blueValue</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=n>num_valid_pixels</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>blurred_pix</span><span class=p>;</span><span class=w></span>
<span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=kt>void</span><span class=w> </span><span class=nf>blur</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=n>RGBTRIPLE</span><span class=w> </span><span class=n>blur_image</span><span class=p>[</span><span class=n>height</span><span class=p>][</span><span class=n>width</span><span class=p>];</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>width</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>blur_image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>get_blur</span><span class=p>(</span><span class=n>i</span><span class=p>,</span><span class=w> </span><span class=n>j</span><span class=p>,</span><span class=w> </span><span class=n>height</span><span class=p>,</span><span class=w> </span><span class=n>width</span><span class=p>,</span><span class=w> </span><span class=n>image</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>height</span><span class=p>;</span><span class=w> </span><span class=n>i</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=k>for</span><span class=w> </span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=w> </span><span class=o>&lt;</span><span class=w> </span><span class=n>width</span><span class=p>;</span><span class=w> </span><span class=n>j</span><span class=o>++</span><span class=p>)</span><span class=w></span>
<span class=w>            </span><span class=n>image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>blur_image</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>];</span><span class=w></span>
<span class=p>}</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <h2 id=recover>Recover</h2> <p>Implement a program that recovers JPEGs from a forensic image, per the below. </p> <div class=highlight><pre><span></span><code>$ ./recover card.raw
</code></pre></div> <h3 id=background_1><strong>Background</strong></h3> <p>Sometimes, after taking an image, we may delete them by accident. Thankfully, in the computer world, “deleted” tends not to mean “deleted” so much as “forgotten.” Even though the camera insists that the card is now blank, we’re pretty sure that’s not quite true. </p> <p>Even though JPEGs are more complicated than BMPs, JPEGs have “signatures,” patterns of bytes that can distinguish them from other file formats. Specifically, the first three bytes of JPEGs are: </p> <div class=highlight><pre><span></span><code>0xff 0xd8 0xff
</code></pre></div> <p>from first byte to third byte, left to right. The fourth byte, meanwhile, is either <code>0xe0</code>, <code>0xe1</code>, <code>0xe2</code>, <code>0xe3</code>, <code>0xe4</code>, <code>0xe5</code>, <code>0xe6</code>, <code>0xe7</code>, <code>0xe8</code>, <code>0xe9</code>, <code>0xea</code>, <code>0xeb</code>, <code>0xec</code>, <code>0xed</code>, <code>0xee</code>, or <code>0xef</code>. Put another way, the fourth byte’s first four bits are <code>1110</code>. </p> <p>Odds are, if you find this pattern of four bytes on media known to store photos (e.g., my memory card), they demarcate the start of a JPEG. To be fair, you might encounter these patterns on some disk purely by chance, so data recovery isn’t an exact science. </p> <p>Fortunately, digital cameras tend to store photographs contiguously on memory cards, whereby each photo is stored immediately after the previously taken photo. Accordingly, the start of a JPEG usually demarks the end of another. However, digital cameras often initialize cards with a FAT file system whose “block size” is 512 bytes (B). The implication is that these cameras only write to those cards in units of 512 B. A photo that’s 1 MB (i.e., 1,048,576 B) thus takes up 1048576 ÷ 512 = 2048 “blocks” on a memory card. But so does a photo that’s, say, one byte smaller (i.e., 1,048,575 B)! The wasted space on disk is called “slack space.” Forensic investigators often look at slack space for remnants of suspicious data. </p> <p>The implication of all these details is that you, the investigator, can probably write a program that iterates over a copy of my memory card, looking for JPEGs’ signatures. Each time you find a signature, you can open a new file for writing and start filling that file with bytes from my memory card, closing that file only once you encounter another signature. Moreover, rather than read my memory card’s bytes one at a time, you can read 512 of them at a time into a buffer for efficiency’s sake. Thanks to FAT, you can trust that JPEGs’ signatures will be “block-aligned.” That is, you need only look for those signatures in a block’s first four bytes. </p> <p>Realize, of course, that JPEGs can span contiguous blocks. Otherwise, no JPEG could be larger than 512 B. But the last byte of a JPEG might not fall at the very end of a block. Recall the possibility of slack space. But not to worry. Because this memory card was brand-new when I started snapping photos, odds are it’d been “zeroed” (i.e., filled with 0s) by the manufacturer, in which case any slack space will be filled with 0s. It’s okay if those trailing 0s end up in the JPEGs you recover; they should still be viewable.<br> Now, I only have one memory card, but there are a lot of you! And so I’ve gone ahead and created a “forensic image” of the card, storing its contents, byte after byte, in a file called <code>card.raw</code>. So that you don’t waste time iterating over millions of 0s unnecessarily, I’ve only imaged the first few megabytes of the memory card. But you should ultimately find that the image contains 50 JPEGs. </p> <h3 id=problem-solving_1><strong>Problem Solving</strong></h3> <p>Get the files for the recovery problem <a href=https://cdn.cs50.net/2019/fall/psets/4/recover/recover.zip>HERE</a>. </p> <p>Let's take a look at the code provided in the .zip: </p> <details class=example> <summary><code>recover.c</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal>1</span>
<span class=normal>2</span>
<span class=normal>3</span>
<span class=normal>4</span>
<span class=normal>5</span>
<span class=normal>6</span>
<span class=normal>7</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>argv</span><span class=p>[])</span><span class=w></span>
<span class=p>{</span><span class=w></span>

<span class=p>}</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> <p>The above code is basically bare of anything, which means we should break down what we need to do: </p> <p><strong>Tasks</strong> </p> <ul> <li> <p>Open memory card </p> </li> <li> <p>Look for beginning of a JPEG </p> </li> <li> <p>Open a new JPEG file </p> </li> <li> <p>Write 512 bytes until a new JPEG is found </p> </li> <li> <p>Stop at the end of the file </p> </li> </ul> <p>Let's look at some things we can do for each step: </p> <p><strong>Open memory card</strong></p> <p>We can take advantage of the <code>fopen()</code> function to open the memory card: </p> <p><div class=highlight><pre><span></span><code><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>f</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=w> </span><span class=s>&quot;r&quot;</span><span class=p>);</span><span class=w></span>
</code></pre></div> Here inside the <code>fopen();</code> the filename is the name of the file you are trying to open and the <code>"r"</code> means you want to read the files. </p> <p><strong>Look for beginning of a JPEG</strong> </p> <p>As mentioned previously, each JPEG file starts with a distinct header, meaning that first byte is always <code>0xff</code>, the second byte is always <code>0xd8</code>, the third byte is always <code>0xff</code>, and the fourth byte can vary a little bit, but always start with <code>0xe</code>. </p> <p>Luckily for us, each JPEG is stored back-to-back in this problem file. </p> <p>We can utilize the <code>fread()</code> function to look for JPEGs. </p> <p><div class=highlight><pre><span></span><code><span class=n>fread</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>size</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>,</span><span class=w> </span><span class=n>inptr</span><span class=p>);</span><span class=w></span>
</code></pre></div> The above code can be broken down as: </p> <ul> <li> <p><code>data</code>: pointer to where to store data you're reading.</p> </li> <li> <p><code>size</code>: size of each element to read.</p> </li> <li> <p><code>number</code>: number of elements to read.</p> </li> <li> <p><code>inptr</code>: <code>FILE *</code> to read from. </p> </li> </ul> <p>For example, we can check to see if the first byte of an array, for example called <code>buffer</code>, contains <code>0xff</code>: </p> <p><div class=highlight><pre><span></span><code><span class=n>buffer</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xff</span><span class=w></span>
<span class=n>buffer</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xd8</span><span class=w></span>
<span class=n>buffer</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xff</span><span class=w></span>
</code></pre></div> <code>buffer[3]</code> is a little bit more confusing because it can vary. We could use a boolean expression here to check all the different variations to start: </p> <p><div class=highlight><pre><span></span><code><span class=n>buffer</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xe0</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xe1</span><span class=w> </span><span class=o>||</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xe2</span><span class=w></span>
<span class=p>...</span><span class=w></span>
</code></pre></div> But having to write out all 16 variations could become tedious. For a shortcut, we could use bitwise arithmatic: </p> <p><div class=highlight><pre><span></span><code><span class=p>(</span><span class=n>buffer</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0xf0</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xe0</span><span class=w></span>
</code></pre></div> This is going to say to look at the first 4 bits of this 8 bit byte, and set the remaining 4 bytes to zero. This clears out the last 4 bits and compares the results. </p> <p><strong>Open a new JPEG file</strong> </p> <p>After we find a JPEG, we need to make a new JPEG file. To begin we need to have filenames set as <code>###.jpg</code>, starting at <code>000.jpg</code>. This will help us keep track of the number of JPEGs found. </p> <p>We can utilize the <code>sprintf()</code> function here, where instead of printing to the terminal, it prints to a <code>string</code>. </p> <p>For example, we could use the following code: </p> <p><div class=highlight><pre><span></span><code><span class=n>sprintf</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=w> </span><span class=s>&quot;%03i.jpg&quot;</span><span class=p>,</span><span class=w> </span><span class=mi>2</span><span class=p>);</span><span class=w></span>
</code></pre></div> <code>%03i.jpg</code> simply means to print an integer with 3 digits. </p> <p>Next, to create the new file, we can use the <code>fopen()</code> function again: </p> <p><div class=highlight><pre><span></span><code><span class=kt>FILE</span><span class=w> </span><span class=o>*</span><span class=n>img</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=w> </span><span class=s>&quot;w&quot;</span><span class=p>);</span><span class=w></span>
</code></pre></div> Notice the <code>"w"</code>, which stands for write. </p> <p>To begin writing the new file, we can use the <code>fwrite</code> function: </p> <p><div class=highlight><pre><span></span><code><span class=n>fwrite</span><span class=p>(</span><span class=n>data</span><span class=p>,</span><span class=w> </span><span class=n>size</span><span class=p>,</span><span class=w> </span><span class=n>number</span><span class=p>,</span><span class=w> </span><span class=n>outptr</span><span class=p>);</span><span class=w></span>
</code></pre></div> The above code can be broken down as: </p> <ul> <li> <p><code>data</code>: pointer to bytes that will be written to file.</p> </li> <li> <p><code>size</code>: size of each element to write.</p> </li> <li> <p><code>number</code>: number of elements to write.</p> </li> <li> <p><code>outptr</code>: <code>FILE *</code> to write to. </p> </li> <li> <p>Returns number of items of size <code>size</code> were read. </p> </li> </ul> <p><strong>Pseudocode</strong><br> <div class=highlight><pre><span></span><code>Open memory card
Repeat until end of card: 
    Read 512 bytes into a buffer
    If start of new JPEG
        If first JPEG
            ...
        Else
            ...
    Else
        If already found JPEG
</code></pre></div></p> <h3 id=solution>Solution</h3> <details class=example> <summary><code>recover.c</code> code</summary> <table class=highlighttable><tr><td class=linenos><div class=linenodiv><pre><span></span><span class=normal> 1</span>
<span class=normal> 2</span>
<span class=normal> 3</span>
<span class=normal> 4</span>
<span class=normal> 5</span>
<span class=normal> 6</span>
<span class=normal> 7</span>
<span class=normal> 8</span>
<span class=normal> 9</span>
<span class=normal>10</span>
<span class=normal>11</span>
<span class=normal>12</span>
<span class=normal>13</span>
<span class=normal>14</span>
<span class=normal>15</span>
<span class=normal>16</span>
<span class=normal>17</span>
<span class=normal>18</span>
<span class=normal>19</span>
<span class=normal>20</span>
<span class=normal>21</span>
<span class=normal>22</span>
<span class=normal>23</span>
<span class=normal>24</span>
<span class=normal>25</span>
<span class=normal>26</span>
<span class=normal>27</span>
<span class=normal>28</span>
<span class=normal>29</span>
<span class=normal>30</span>
<span class=normal>31</span>
<span class=normal>32</span>
<span class=normal>33</span>
<span class=normal>34</span>
<span class=normal>35</span>
<span class=normal>36</span>
<span class=normal>37</span>
<span class=normal>38</span>
<span class=normal>39</span>
<span class=normal>40</span>
<span class=normal>41</span>
<span class=normal>42</span>
<span class=normal>43</span>
<span class=normal>44</span>
<span class=normal>45</span>
<span class=normal>46</span>
<span class=normal>47</span>
<span class=normal>48</span>
<span class=normal>49</span>
<span class=normal>50</span>
<span class=normal>51</span>
<span class=normal>52</span>
<span class=normal>53</span>
<span class=normal>54</span>
<span class=normal>55</span>
<span class=normal>56</span>
<span class=normal>57</span>
<span class=normal>58</span>
<span class=normal>59</span></pre></div></td><td class=code><div class=highlight><pre><span></span><code><span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdio.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdlib.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;cs50.h&gt;</span><span class=cp></span>
<span class=cp>#include</span><span class=w> </span><span class=cpf>&lt;stdint.h&gt;</span><span class=cp></span>
<span class=k>typedef</span><span class=w> </span><span class=kt>uint8_t</span><span class=w> </span><span class=n>BYTE</span><span class=p>;</span><span class=w> </span><span class=c1>//defining BYTE as a byte (unsigned integer of length = 8 bits)</span>
<span class=cp>#define BLOCK_SIZE 512 </span><span class=c1>// setting BLOCK_SIZE to 512 bytes</span>
<span class=cp>#define FILE_NAME_SIZE 8</span>
<span class=kt>bool</span><span class=w> </span><span class=nf>start_jpeg</span><span class=p>(</span><span class=n>BYTE</span><span class=w> </span><span class=n>buffer</span><span class=p>[]);</span><span class=w></span>

<span class=kt>int</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=kt>int</span><span class=w> </span><span class=n>argc</span><span class=p>,</span><span class=w> </span><span class=kt>char</span><span class=w> </span><span class=o>*</span><span class=n>argv</span><span class=p>[])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>argc</span><span class=w> </span><span class=o>!=</span><span class=mi>2</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;Usage: ./recover image</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=kt>FILE</span><span class=o>*</span><span class=w> </span><span class=n>infile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span><span class=w> </span><span class=s>&quot;r&quot;</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>infile</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=n>printf</span><span class=p>(</span><span class=s>&quot;File not found</span><span class=se>\n</span><span class=s>&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>

<span class=w>    </span><span class=n>BYTE</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=n>BLOCK_SIZE</span><span class=p>];</span><span class=w></span>
<span class=w>    </span><span class=kt>int</span><span class=w> </span><span class=n>file_index</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>0</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=kt>bool</span><span class=w> </span><span class=n>first_jpeg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>false</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=kt>FILE</span><span class=o>*</span><span class=w> </span><span class=n>outfile</span><span class=p>;</span><span class=w></span>
<span class=w>    </span><span class=k>while</span><span class=w> </span><span class=p>(</span><span class=n>fread</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=n>BLOCK_SIZE</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>infile</span><span class=p>))</span><span class=w></span>
<span class=w>    </span><span class=p>{</span><span class=w></span>
<span class=w>        </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>start_jpeg</span><span class=p>(</span><span class=n>buffer</span><span class=p>))</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=o>!</span><span class=n>first_jpeg</span><span class=p>)</span><span class=w></span>
<span class=w>                </span><span class=n>first_jpeg</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=nb>true</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=k>else</span><span class=w></span>
<span class=w>                </span><span class=n>fclose</span><span class=p>(</span><span class=n>outfile</span><span class=p>);</span><span class=w></span>

<span class=w>            </span><span class=kt>char</span><span class=w> </span><span class=n>filename</span><span class=p>(</span><span class=n>FILE_NAME_SIZE</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=n>sprintf</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=w> </span><span class=s>&quot;%03i.jpg&quot;</span><span class=p>,</span><span class=w> </span><span class=n>file_index</span><span class=o>++</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=n>outfile</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>fopen</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=w> </span><span class=s>&quot;w&quot;</span><span class=p>);</span><span class=w></span>
<span class=w>            </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>outfile</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=nb>NULL</span><span class=p>)</span><span class=w></span>
<span class=w>                </span><span class=k>return</span><span class=w> </span><span class=mi>1</span><span class=p>;</span><span class=w></span>
<span class=w>            </span><span class=n>fwrite</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=n>BLOCK_SIZE</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>outfile</span><span class=p>);</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>

<span class=w>        </span><span class=k>else</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=p>(</span><span class=n>first_jpeg</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>{</span><span class=w></span>
<span class=w>            </span><span class=n>fwrite</span><span class=p>(</span><span class=n>buffer</span><span class=p>,</span><span class=w> </span><span class=n>BLOCK_SIZE</span><span class=p>,</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>outfile</span><span class=p>)</span><span class=w></span>
<span class=w>        </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=p>}</span><span class=w></span>
<span class=w>    </span><span class=n>fclose</span><span class=p>(</span><span class=n>outfile</span><span class=p>);</span><span class=w></span>
<span class=w>    </span><span class=n>fclose</span><span class=p>(</span><span class=n>infile</span><span class=p>);</span><span class=w></span>

<span class=p>}</span><span class=w></span>

<span class=kt>bool</span><span class=w> </span><span class=nf>start_jpeg</span><span class=p>(</span><span class=n>BYTE</span><span class=w> </span><span class=n>buffer</span><span class=p>[])</span><span class=w></span>
<span class=p>{</span><span class=w></span>
<span class=w>    </span><span class=k>return</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xff</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xd8</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=n>buffer</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xff</span><span class=w> </span><span class=o>&amp;&amp;</span><span class=w> </span><span class=p>(</span><span class=n>buffer</span><span class=p>[</span><span class=mi>3</span><span class=p>]</span><span class=w> </span><span class=o>&amp;</span><span class=w> </span><span class=mh>0xf0</span><span class=p>)</span><span class=w> </span><span class=o>==</span><span class=w> </span><span class=mh>0xe0</span><span class=p>;</span><span class=w></span>

<span class=p>}</span><span class=w></span>
</code></pre></div> </td></tr></table> </details> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../c-memory/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Memory Overview" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Memory Overview </div> </div> </a> <a href=../c-data-structures/ class="md-footer__link md-footer__link--next" aria-label="Next: Data Structures Overview" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Data Structures Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> <div class=md-social> <a href=https://nicklyss.com target=_blank rel=noopener title=nicklyss.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 576 512"><path d="M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v208c0 44.112 35.888 80 80 80h336zm96-80V80c0-26.51-21.49-48-48-48H144c-26.51 0-48 21.49-48 48v256c0 26.51 21.49 48 48 48h384c26.51 0 48-21.49 48-48zM256 128c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-96 144 55.515-55.515c4.686-4.686 12.284-4.686 16.971 0L272 256l135.515-135.515c4.686-4.686 12.284-4.686 16.971 0L512 208v112H160v-48z"/></svg> </a> <a href=https://blog.nicklyss.com target=_blank rel=noopener title=blog.nicklyss.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M172.2 226.8c-14.6-2.9-28.2 8.9-28.2 23.8V301c0 10.2 7.1 18.4 16.7 22 18.2 6.8 31.3 24.4 31.3 45 0 26.5-21.5 48-48 48s-48-21.5-48-48V120c0-13.3-10.7-24-24-24H24c-13.3 0-24 10.7-24 24v248c0 89.5 82.1 160.2 175 140.7 54.4-11.4 98.3-55.4 109.7-109.7 17.4-82.9-37-157.2-112.5-172.2zM209 0c-9.2-.5-17 6.8-17 16v31.6c0 8.5 6.6 15.5 15 15.9 129.4 7 233.4 112 240.9 241.5.5 8.4 7.5 15 15.9 15h32.1c9.2 0 16.5-7.8 16-17C503.4 139.8 372.2 8.6 209 0zm.3 96c-9.3-.7-17.3 6.7-17.3 16.1v32.1c0 8.4 6.5 15.3 14.8 15.9 76.8 6.3 138 68.2 144.9 145.2.8 8.3 7.6 14.7 15.9 14.7h32.2c9.3 0 16.8-8 16.1-17.3-8.4-110.1-96.5-198.2-206.6-206.7z"/></svg> </a> <a href=https://www.linkedin.com/in/nicholas-platt/ target=_blank rel=noopener title=www.linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg> </a> <a href=https://github.com/tpbnick target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> </a> <a href=https://www.instagram.com/nickplattfour/ target=_blank rel=noopener title=www.instagram.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"/></svg> </a> <a href=mailto:nick@nickplatt.dev target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><path d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "navigation.tracking", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.22074ed6.min.js"}</script> <script src=../assets/javascripts/bundle.01de222e.min.js></script> <script src=../javascripts/extra.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> <script>
    var elements = document.getElementsByClassName("lightgallery");
    for(var i=0; i<elements.length; i++) {
       lightGallery(elements[i]);
    }
    </script> </body> </html>